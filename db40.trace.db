2024-05-01 13:28:26.780510+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT name, count(project.id) AS project_count FROM client\000d\000a                                                         FULL [*]JOIN project ON project.client_id = client.id\000d\000aGROUP BY name\000d\000aHAVING count(project.id) IN (\000d\000a    SELECT count(project.id) FROM project\000d\000a    GROUP BY client_id\000d\000a    ORDER BY count(id) DESC\000d\000a    LIMIT 1\000d\000a    );"
Syntax error in SQL statement "SELECT name, count(project.id) AS project_count FROM client\000d\000a                                                         FULL [*]JOIN project ON project.client_id = client.id\000d\000aGROUP BY name\000d\000aHAVING count(project.id) IN (\000d\000a    SELECT count(project.id) FROM project\000d\000a    GROUP BY client_id\000d\000a    ORDER BY count(id) DESC\000d\000a    LIMIT 1\000d\000a    );"; SQL statement:
SELECT name, count(project.id) AS project_count FROM client
                                                         FULL JOIN project ON project.client_id = client.id
GROUP BY name
HAVING count(project.id) IN (
    SELECT count(project.id) FROM project
    GROUP BY client_id
    ORDER BY count(id) DESC
    LIMIT 1
    ); [42000-224]
2024-05-01 13:29:04.793251+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT name, count(project.id) AS project_count FROM client\000d\000a                                                         FULL [*]JOIN project ON project.client_id = client.id\000d\000aGROUP BY name\000d\000aHAVING count(project.id) IN (\000d\000a    SELECT count(project.id) FROM project\000d\000a    GROUP BY client_id\000d\000a    ORDER BY count(id) DESC\000d\000a    LIMIT 1\000d\000a    );"
Syntax error in SQL statement "SELECT name, count(project.id) AS project_count FROM client\000d\000a                                                         FULL [*]JOIN project ON project.client_id = client.id\000d\000aGROUP BY name\000d\000aHAVING count(project.id) IN (\000d\000a    SELECT count(project.id) FROM project\000d\000a    GROUP BY client_id\000d\000a    ORDER BY count(id) DESC\000d\000a    LIMIT 1\000d\000a    );"; SQL statement:
SELECT name, count(project.id) AS project_count FROM client
                                                         FULL JOIN project ON project.client_id = client.id
GROUP BY name
HAVING count(project.id) IN (
    SELECT count(project.id) FROM project
    GROUP BY client_id
    ORDER BY count(id) DESC
    LIMIT 1
    ); [42000-224]
2024-05-01 13:29:59.930660+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT name, count(project.id) AS project_count FROM client\000d\000a                                                         FULL [*]JOIN project ON project.client_id = client.id\000d\000aGROUP BY name\000d\000aHAVING count(project.id) IN (\000d\000a    SELECT count(project.id) FROM project\000d\000a    GROUP BY client_id\000d\000a    ORDER BY count(id) DESC\000d\000a    LIMIT 1\000d\000a    );"
Syntax error in SQL statement "SELECT name, count(project.id) AS project_count FROM client\000d\000a                                                         FULL [*]JOIN project ON project.client_id = client.id\000d\000aGROUP BY name\000d\000aHAVING count(project.id) IN (\000d\000a    SELECT count(project.id) FROM project\000d\000a    GROUP BY client_id\000d\000a    ORDER BY count(id) DESC\000d\000a    LIMIT 1\000d\000a    );"; SQL statement:
SELECT name, count(project.id) AS project_count FROM client
                                                         FULL JOIN project ON project.client_id = client.id
GROUP BY name
HAVING count(project.id) IN (
    SELECT count(project.id) FROM project
    GROUP BY client_id
    ORDER BY count(id) DESC
    LIMIT 1
    ); [42000-224]
2024-05-01 13:30:26.134848+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT name, count(project.id) AS project_count FROM client\000d\000a                                                         FULL [*]JOIN project ON project.client_id = client.id\000d\000aGROUP BY name\000d\000aHAVING count(project.id) IN (\000d\000a    SELECT count(project.id) FROM project\000d\000a    GROUP BY client_id\000d\000a    ORDER BY count(id) DESC\000d\000a    LIMIT 1\000d\000a    );"
Syntax error in SQL statement "SELECT name, count(project.id) AS project_count FROM client\000d\000a                                                         FULL [*]JOIN project ON project.client_id = client.id\000d\000aGROUP BY name\000d\000aHAVING count(project.id) IN (\000d\000a    SELECT count(project.id) FROM project\000d\000a    GROUP BY client_id\000d\000a    ORDER BY count(id) DESC\000d\000a    LIMIT 1\000d\000a    );"; SQL statement:
SELECT name, count(project.id) AS project_count FROM client
                                                         FULL JOIN project ON project.client_id = client.id
GROUP BY name
HAVING count(project.id) IN (
    SELECT count(project.id) FROM project
    GROUP BY client_id
    ORDER BY count(id) DESC
    LIMIT 1
    ); [42000-224]
2024-05-01 13:31:34.993000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT name, count(project.id) AS project_count FROM client\000d\000aFULL [*]JOIN project ON project.client_id = client.id\000d\000aGROUP BY name\000d\000aHAVING count(project.id) IN (\000d\000a    SELECT count(project.id) FROM project\000d\000a    GROUP BY client_id\000d\000a    ORDER BY count(id) DESC\000d\000a    LIMIT 1\000d\000a    )"
Syntax error in SQL statement "SELECT name, count(project.id) AS project_count FROM client\000d\000aFULL [*]JOIN project ON project.client_id = client.id\000d\000aGROUP BY name\000d\000aHAVING count(project.id) IN (\000d\000a    SELECT count(project.id) FROM project\000d\000a    GROUP BY client_id\000d\000a    ORDER BY count(id) DESC\000d\000a    LIMIT 1\000d\000a    )"; SQL statement:
SELECT name, count(project.id) AS project_count FROM client
FULL JOIN project ON project.client_id = client.id
GROUP BY name
HAVING count(project.id) IN (
    SELECT count(project.id) FROM project
    GROUP BY client_id
    ORDER BY count(id) DESC
    LIMIT 1
    ) [42000-224]
2024-05-01 13:32:09.409000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT name, count (project.id) AS project_count FROM client\000d\000aFULL [*]JOIN project ON project.client_id = client.id\000d\000aGROUP BY name\000d\000aHAVING count(project.id) IN (\000d\000a    SELECT count(project.id) FROM project\000d\000a    GROUP BY client_id\000d\000a    ORDER BY count(id) DESC\000d\000a    LIMIT 1\000d\000a    )"
Syntax error in SQL statement "SELECT name, count (project.id) AS project_count FROM client\000d\000aFULL [*]JOIN project ON project.client_id = client.id\000d\000aGROUP BY name\000d\000aHAVING count(project.id) IN (\000d\000a    SELECT count(project.id) FROM project\000d\000a    GROUP BY client_id\000d\000a    ORDER BY count(id) DESC\000d\000a    LIMIT 1\000d\000a    )"; SQL statement:
SELECT name, count (project.id) AS project_count FROM client
FULL JOIN project ON project.client_id = client.id
GROUP BY name
HAVING count(project.id) IN (
    SELECT count(project.id) FROM project
    GROUP BY client_id
    ORDER BY count(id) DESC
    LIMIT 1
    ) [42000-224]
2024-05-01 13:32:36.163576+03:00 database: flush
org.h2.message.DbException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.message.DbException.convert(DbException.java:407)
	at org.h2.mvstore.db.Store.lambda$new$0(Store.java:122)
	at org.h2.mvstore.MVStore.handleException(MVStore.java:1546)
	at org.h2.mvstore.MVStore.panic(MVStore.java:371)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:291)
	at org.h2.mvstore.MVStore$Builder.open(MVStore.java:2035)
	at org.h2.mvstore.db.Store.<init>(Store.java:133)
	at org.h2.engine.Database.<init>(Database.java:326)
	at org.h2.engine.Engine.openSession(Engine.java:92)
	at org.h2.engine.Engine.openSession(Engine.java:222)
	at org.h2.engine.Engine.createSession(Engine.java:201)
	at org.h2.engine.SessionRemote.connectEmbeddedOrServer(SessionRemote.java:343)
	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:125)
	at org.h2.Driver.connect(Driver.java:59)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:683)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:253)
	at org.boichenko.Database.<init>(Database.java:13)
	at org.boichenko.Database.<clinit>(Database.java:9)
	at org.boichenko.services.DatabaseQueryService.findMaxProjectsClient(DatabaseQueryService.java:37)
	at org.boichenko.services.DatabaseQueryService.main(DatabaseQueryService.java:30)
Caused by: org.h2.jdbc.JdbcSQLNonTransientException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:566)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	... 21 more
Caused by: org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:996)
	at org.h2.mvstore.SingleFileStore.lockFileChannel(SingleFileStore.java:143)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:117)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:81)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:286)
	... 15 more
2024-05-01 13:41:59.987000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Функция "AGE" не найдена
Function "AGE" not found; SQL statement:
SELECT id AS project_name, EXTRACT(year FROM AGE(finish_date, start_date)) * 12 +
                           EXTRACT(month FROM AGE(finish_date, start_date)) AS month_count FROM project [90022-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.Parser.readFunction(Parser.java:3786)
	at org.h2.command.Parser.readTermWithIdentifier(Parser.java:5148)
	at org.h2.command.Parser.readTerm(Parser.java:4834)
	at org.h2.command.Parser.readFactor(Parser.java:3337)
	at org.h2.command.Parser.readSum(Parser.java:3324)
	at org.h2.command.Parser.readConcat(Parser.java:3289)
	at org.h2.command.Parser.readCondition(Parser.java:3079)
	at org.h2.command.Parser.readExpression(Parser.java:2999)
	at org.h2.command.Parser.readSingleArgument(Parser.java:4466)
	at org.h2.command.Parser.readBuiltinFunctionIf(Parser.java:4095)
	at org.h2.command.Parser.readFunction(Parser.java:3768)
	at org.h2.command.Parser.readTermWithIdentifier(Parser.java:5148)
	at org.h2.command.Parser.readTerm(Parser.java:4834)
	at org.h2.command.Parser.readFactor(Parser.java:3337)
	at org.h2.command.Parser.readSum(Parser.java:3324)
	at org.h2.command.Parser.readConcat(Parser.java:3289)
	at org.h2.command.Parser.readCondition(Parser.java:3079)
	at org.h2.command.Parser.readExpression(Parser.java:2999)
	at org.h2.command.Parser.parseSelectExpressions(Parser.java:2799)
	at org.h2.command.Parser.parseSelect(Parser.java:2817)
	at org.h2.command.Parser.parseQueryPrimary(Parser.java:2708)
	at org.h2.command.Parser.parseQueryTerm(Parser.java:2564)
	at org.h2.command.Parser.parseQueryExpressionBody(Parser.java:2543)
	at org.h2.command.Parser.parseQueryExpressionBodyAndEndOfQuery(Parser.java:2536)
	at org.h2.command.Parser.parseQueryExpression(Parser.java:2529)
	at org.h2.command.Parser.parseQuery(Parser.java:2498)
	at org.h2.command.Parser.parsePrepared(Parser.java:627)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1109)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1096)
	at org.h2.server.web.WebThread.process(WebThread.java:190)
	at org.h2.server.web.WebThread.run(WebThread.java:103)
	at java.lang.Thread.run(Unknown Source)
2024-05-01 13:50:05.265000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLDataException: Недопустимое значение "DATEDIFF" для параметра "date-time field"
Invalid value "DATEDIFF" for parameter "date-time field"; SQL statement:
SELECT id AS project_name, EXTRACT(DATEDIFF(dd, finish_date, start_date)/365.25)) [90008-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:658)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.getInvalidValueException(DbException.java:298)
	at org.h2.expression.function.DateTimeFunction.getField(DateTimeFunction.java:326)
	at org.h2.command.Parser.readDateTimeField(Parser.java:4562)
	at org.h2.command.Parser.readBuiltinFunctionIf(Parser.java:4093)
	at org.h2.command.Parser.readFunction(Parser.java:3768)
	at org.h2.command.Parser.readTermWithIdentifier(Parser.java:5148)
	at org.h2.command.Parser.readTerm(Parser.java:4834)
	at org.h2.command.Parser.readFactor(Parser.java:3337)
	at org.h2.command.Parser.readSum(Parser.java:3324)
	at org.h2.command.Parser.readConcat(Parser.java:3289)
	at org.h2.command.Parser.readCondition(Parser.java:3079)
	at org.h2.command.Parser.readExpression(Parser.java:2999)
	at org.h2.command.Parser.parseSelectExpressions(Parser.java:2799)
	at org.h2.command.Parser.parseSelect(Parser.java:2817)
	at org.h2.command.Parser.parseQueryPrimary(Parser.java:2708)
	at org.h2.command.Parser.parseQueryTerm(Parser.java:2564)
	at org.h2.command.Parser.parseQueryExpressionBody(Parser.java:2543)
	at org.h2.command.Parser.parseQueryExpressionBodyAndEndOfQuery(Parser.java:2536)
	at org.h2.command.Parser.parseQueryExpression(Parser.java:2529)
	at org.h2.command.Parser.parseQuery(Parser.java:2498)
	at org.h2.command.Parser.parsePrepared(Parser.java:627)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1109)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1096)
	at org.h2.server.web.WebThread.process(WebThread.java:190)
	at org.h2.server.web.WebThread.run(WebThread.java:103)
	at java.lang.Thread.run(Unknown Source)
2024-05-01 13:50:23.979000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLDataException: Недопустимое значение "DATEDIFF" для параметра "date-time field"
Invalid value "DATEDIFF" for parameter "date-time field"; SQL statement:
SELECT id AS project_name, EXTRACT(DATEDIFF(dd, finish_date, start_date))) [90008-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:658)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.getInvalidValueException(DbException.java:298)
	at org.h2.expression.function.DateTimeFunction.getField(DateTimeFunction.java:326)
	at org.h2.command.Parser.readDateTimeField(Parser.java:4562)
	at org.h2.command.Parser.readBuiltinFunctionIf(Parser.java:4093)
	at org.h2.command.Parser.readFunction(Parser.java:3768)
	at org.h2.command.Parser.readTermWithIdentifier(Parser.java:5148)
	at org.h2.command.Parser.readTerm(Parser.java:4834)
	at org.h2.command.Parser.readFactor(Parser.java:3337)
	at org.h2.command.Parser.readSum(Parser.java:3324)
	at org.h2.command.Parser.readConcat(Parser.java:3289)
	at org.h2.command.Parser.readCondition(Parser.java:3079)
	at org.h2.command.Parser.readExpression(Parser.java:2999)
	at org.h2.command.Parser.parseSelectExpressions(Parser.java:2799)
	at org.h2.command.Parser.parseSelect(Parser.java:2817)
	at org.h2.command.Parser.parseQueryPrimary(Parser.java:2708)
	at org.h2.command.Parser.parseQueryTerm(Parser.java:2564)
	at org.h2.command.Parser.parseQueryExpressionBody(Parser.java:2543)
	at org.h2.command.Parser.parseQueryExpressionBodyAndEndOfQuery(Parser.java:2536)
	at org.h2.command.Parser.parseQueryExpression(Parser.java:2529)
	at org.h2.command.Parser.parseQuery(Parser.java:2498)
	at org.h2.command.Parser.parsePrepared(Parser.java:627)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1109)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1096)
	at org.h2.server.web.WebThread.process(WebThread.java:190)
	at org.h2.server.web.WebThread.run(WebThread.java:103)
	at java.lang.Thread.run(Unknown Source)
2024-05-01 13:53:52.312000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLDataException: Недопустимое значение "DATEDIFF" для параметра "date-time field"
Invalid value "DATEDIFF" for parameter "date-time field"; SQL statement:
SELECT id AS project_name, EXTRACT(DATEDIFF(dd, PARSEDATETIME(FORMATDATETIME(finish_date, 'yyyy-MM-dd'), 'yyyy-MM-dd'), PARSEDATETIME(FORMATDATETIME(start_date, 'yyyy-MM-dd'), 'yyyy-MM-dd')))) [90008-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:658)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.getInvalidValueException(DbException.java:298)
	at org.h2.expression.function.DateTimeFunction.getField(DateTimeFunction.java:326)
	at org.h2.command.Parser.readDateTimeField(Parser.java:4562)
	at org.h2.command.Parser.readBuiltinFunctionIf(Parser.java:4093)
	at org.h2.command.Parser.readFunction(Parser.java:3768)
	at org.h2.command.Parser.readTermWithIdentifier(Parser.java:5148)
	at org.h2.command.Parser.readTerm(Parser.java:4834)
	at org.h2.command.Parser.readFactor(Parser.java:3337)
	at org.h2.command.Parser.readSum(Parser.java:3324)
	at org.h2.command.Parser.readConcat(Parser.java:3289)
	at org.h2.command.Parser.readCondition(Parser.java:3079)
	at org.h2.command.Parser.readExpression(Parser.java:2999)
	at org.h2.command.Parser.parseSelectExpressions(Parser.java:2799)
	at org.h2.command.Parser.parseSelect(Parser.java:2817)
	at org.h2.command.Parser.parseQueryPrimary(Parser.java:2708)
	at org.h2.command.Parser.parseQueryTerm(Parser.java:2564)
	at org.h2.command.Parser.parseQueryExpressionBody(Parser.java:2543)
	at org.h2.command.Parser.parseQueryExpressionBodyAndEndOfQuery(Parser.java:2536)
	at org.h2.command.Parser.parseQueryExpression(Parser.java:2529)
	at org.h2.command.Parser.parseQuery(Parser.java:2498)
	at org.h2.command.Parser.parsePrepared(Parser.java:627)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1109)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1096)
	at org.h2.server.web.WebThread.process(WebThread.java:190)
	at org.h2.server.web.WebThread.run(WebThread.java:103)
	at java.lang.Thread.run(Unknown Source)
2024-05-01 13:54:53.922000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT id AS project_name, DATEDIFF(dd, finish_date, start_date)[*])"
Syntax error in SQL statement "SELECT id AS project_name, DATEDIFF(dd, finish_date, start_date)[*])"; SQL statement:
SELECT id AS project_name, DATEDIFF(dd, finish_date, start_date)) [42000-224]
2024-05-01 13:54:54.586000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT id AS project_name, DATEDIFF(dd, finish_date, start_date)[*])"
Syntax error in SQL statement "SELECT id AS project_name, DATEDIFF(dd, finish_date, start_date)[*])"; SQL statement:
SELECT id AS project_name, DATEDIFF(dd, finish_date, start_date)) [42000-224]
2024-05-01 13:54:55.031000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT id AS project_name, DATEDIFF(dd, finish_date, start_date)[*])"
Syntax error in SQL statement "SELECT id AS project_name, DATEDIFF(dd, finish_date, start_date)[*])"; SQL statement:
SELECT id AS project_name, DATEDIFF(dd, finish_date, start_date)) [42000-224]
2024-05-01 13:54:55.429000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT id AS project_name, DATEDIFF(dd, finish_date, start_date)[*])"
Syntax error in SQL statement "SELECT id AS project_name, DATEDIFF(dd, finish_date, start_date)[*])"; SQL statement:
SELECT id AS project_name, DATEDIFF(dd, finish_date, start_date)) [42000-224]
2024-05-01 13:55:13.711000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT id AS project_name, DATEDIFF('MONTH', finish_date, start_date)[*])"
Syntax error in SQL statement "SELECT id AS project_name, DATEDIFF('MONTH', finish_date, start_date)[*])"; SQL statement:
SELECT id AS project_name, DATEDIFF('MONTH', finish_date, start_date)) [42000-224]
2024-05-01 13:55:28.100000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT id AS project_name, DATEDIFF('DAY', finish_date, start_date)[*])"
Syntax error in SQL statement "SELECT id AS project_name, DATEDIFF('DAY', finish_date, start_date)[*])"; SQL statement:
SELECT id AS project_name, DATEDIFF('DAY', finish_date, start_date)) [42000-224]
2024-05-01 13:58:35.385000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT id AS project_name, DATEDIFF(DAY, finish_date, start_date)[*])"
Syntax error in SQL statement "SELECT id AS project_name, DATEDIFF(DAY, finish_date, start_date)[*])"; SQL statement:
SELECT id AS project_name, DATEDIFF(DAY, finish_date, start_date)) [42000-224]
2024-05-01 13:58:36.315000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT id AS project_name, DATEDIFF(DAY, finish_date, start_date)[*])"
Syntax error in SQL statement "SELECT id AS project_name, DATEDIFF(DAY, finish_date, start_date)[*])"; SQL statement:
SELECT id AS project_name, DATEDIFF(DAY, finish_date, start_date)) [42000-224]
2024-05-01 13:58:37.244000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT id AS project_name, DATEDIFF(DAY, finish_date, start_date)[*])"
Syntax error in SQL statement "SELECT id AS project_name, DATEDIFF(DAY, finish_date, start_date)[*])"; SQL statement:
SELECT id AS project_name, DATEDIFF(DAY, finish_date, start_date)) [42000-224]
2024-05-01 14:03:10.982000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT id AS project_name, DATEDIFF(day, finish_date, start_date)[*]) FROM project"
Syntax error in SQL statement "SELECT id AS project_name, DATEDIFF(day, finish_date, start_date)[*]) FROM project"; SQL statement:
SELECT id AS project_name, DATEDIFF(day, finish_date, start_date)) FROM project [42000-224]
2024-05-01 14:03:37.512000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT DATEDIFF(day, finish_date, start_date)[*]) FROM project"
Syntax error in SQL statement "SELECT DATEDIFF(day, finish_date, start_date)[*]) FROM project"; SQL statement:
SELECT DATEDIFF(day, finish_date, start_date)) FROM project [42000-224]
2024-05-01 14:11:23.427414+03:00 database: flush
org.h2.message.DbException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.message.DbException.convert(DbException.java:407)
	at org.h2.mvstore.db.Store.lambda$new$0(Store.java:122)
	at org.h2.mvstore.MVStore.handleException(MVStore.java:1546)
	at org.h2.mvstore.MVStore.panic(MVStore.java:371)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:291)
	at org.h2.mvstore.MVStore$Builder.open(MVStore.java:2035)
	at org.h2.mvstore.db.Store.<init>(Store.java:133)
	at org.h2.engine.Database.<init>(Database.java:326)
	at org.h2.engine.Engine.openSession(Engine.java:92)
	at org.h2.engine.Engine.openSession(Engine.java:222)
	at org.h2.engine.Engine.createSession(Engine.java:201)
	at org.h2.engine.SessionRemote.connectEmbeddedOrServer(SessionRemote.java:343)
	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:125)
	at org.h2.Driver.connect(Driver.java:59)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:683)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:253)
	at org.boichenko.Database.<init>(Database.java:13)
	at org.boichenko.Database.<clinit>(Database.java:9)
	at org.boichenko.services.DatabaseQueryService.findLongestProject(DatabaseQueryService.java:37)
	at org.boichenko.services.DatabaseQueryService.main(DatabaseQueryService.java:31)
Caused by: org.h2.jdbc.JdbcSQLNonTransientException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:566)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	... 21 more
Caused by: org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:996)
	at org.h2.mvstore.SingleFileStore.lockFileChannel(SingleFileStore.java:143)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:117)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:81)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:286)
	... 15 more
2024-05-01 14:15:43.644000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Столбец "MONTH_COUNT" не найден
Column "MONTH_COUNT" not found; SQL statement:
SELECT id AS project_name, DATEDIFF(month, start_date, finish_date) as month_count FROM project
WHERE month_count IN (
SELECT DATEDIFF(month, start_date, finish_date) as month_count FROM project
ORDER BY month_count DESC
LIMIT 1
) [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.expression.condition.ConditionInQuery.optimize(ConditionInQuery.java:161)
	at org.h2.expression.Expression.optimizeCondition(Expression.java:148)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1177)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1109)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1096)
	at org.h2.server.web.WebThread.process(WebThread.java:190)
	at org.h2.server.web.WebThread.run(WebThread.java:103)
	at java.lang.Thread.run(Unknown Source)
2024-05-01 14:16:15.873000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Столбец "MONTH_COUNT" не найден
Column "MONTH_COUNT" not found; SQL statement:
SELECT id AS project_name, DATEDIFF(month, start_date, finish_date) as month_count FROM project
WHERE month_count IN (
SELECT DATEDIFF(month, start_date, finish_date) FROM project
ORDER BY month_count DESC
LIMIT 1
) [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1170)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.expression.condition.PredicateWithSubquery.optimize(PredicateWithSubquery.java:37)
	at org.h2.expression.condition.ConditionInQuery.optimize(ConditionInQuery.java:160)
	at org.h2.expression.Expression.optimizeCondition(Expression.java:148)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1177)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1109)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1096)
	at org.h2.server.web.WebThread.process(WebThread.java:190)
	at org.h2.server.web.WebThread.run(WebThread.java:103)
	at java.lang.Thread.run(Unknown Source)
2024-05-01 14:16:49.860600+03:00 database: flush
org.h2.message.DbException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.message.DbException.convert(DbException.java:407)
	at org.h2.mvstore.db.Store.lambda$new$0(Store.java:122)
	at org.h2.mvstore.MVStore.handleException(MVStore.java:1546)
	at org.h2.mvstore.MVStore.panic(MVStore.java:371)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:291)
	at org.h2.mvstore.MVStore$Builder.open(MVStore.java:2035)
	at org.h2.mvstore.db.Store.<init>(Store.java:133)
	at org.h2.engine.Database.<init>(Database.java:326)
	at org.h2.engine.Engine.openSession(Engine.java:92)
	at org.h2.engine.Engine.openSession(Engine.java:222)
	at org.h2.engine.Engine.createSession(Engine.java:201)
	at org.h2.engine.SessionRemote.connectEmbeddedOrServer(SessionRemote.java:343)
	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:125)
	at org.h2.Driver.connect(Driver.java:59)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:683)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:253)
	at org.boichenko.Database.<init>(Database.java:13)
	at org.boichenko.Database.<clinit>(Database.java:9)
	at org.boichenko.services.DatabaseQueryService.findLongestProject(DatabaseQueryService.java:37)
	at org.boichenko.services.DatabaseQueryService.main(DatabaseQueryService.java:31)
Caused by: org.h2.jdbc.JdbcSQLNonTransientException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:566)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	... 21 more
Caused by: org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:996)
	at org.h2.mvstore.SingleFileStore.lockFileChannel(SingleFileStore.java:143)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:117)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:81)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:286)
	... 15 more
2024-05-01 14:27:38.368469+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Столбец "type" не найден
Column "type" not found [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.jdbc.JdbcResultSet.getColumnIndex(JdbcResultSet.java:3518)
	at org.h2.jdbc.JdbcResultSet.getString(JdbcResultSet.java:301)
	at org.boichenko.services.DatabaseQueryService.findYoungestEldestWorker(DatabaseQueryService.java:52)
	at org.boichenko.services.DatabaseQueryService.main(DatabaseQueryService.java:34)
2024-05-01 14:28:44.471775+03:00 database: flush
org.h2.message.DbException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.message.DbException.convert(DbException.java:407)
	at org.h2.mvstore.db.Store.lambda$new$0(Store.java:122)
	at org.h2.mvstore.MVStore.handleException(MVStore.java:1546)
	at org.h2.mvstore.MVStore.panic(MVStore.java:371)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:291)
	at org.h2.mvstore.MVStore$Builder.open(MVStore.java:2035)
	at org.h2.mvstore.db.Store.<init>(Store.java:133)
	at org.h2.engine.Database.<init>(Database.java:326)
	at org.h2.engine.Engine.openSession(Engine.java:92)
	at org.h2.engine.Engine.openSession(Engine.java:222)
	at org.h2.engine.Engine.createSession(Engine.java:201)
	at org.h2.engine.SessionRemote.connectEmbeddedOrServer(SessionRemote.java:343)
	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:125)
	at org.h2.Driver.connect(Driver.java:59)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:683)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:253)
	at org.boichenko.Database.<init>(Database.java:13)
	at org.boichenko.Database.<clinit>(Database.java:9)
	at org.boichenko.services.DatabaseQueryService.findYoungestEldestWorker(DatabaseQueryService.java:42)
	at org.boichenko.services.DatabaseQueryService.main(DatabaseQueryService.java:34)
Caused by: org.h2.jdbc.JdbcSQLNonTransientException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:566)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	... 21 more
Caused by: org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:996)
	at org.h2.mvstore.SingleFileStore.lockFileChannel(SingleFileStore.java:143)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:117)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:81)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:286)
	... 15 more
2024-05-01 14:28:51.794771+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Столбец "birthday" не найден
Column "birthday" not found [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.jdbc.JdbcResultSet.getColumnIndex(JdbcResultSet.java:3518)
	at org.h2.jdbc.JdbcResultSet.getString(JdbcResultSet.java:301)
	at org.boichenko.services.DatabaseQueryService.findYoungestEldestWorker(DatabaseQueryService.java:54)
	at org.boichenko.services.DatabaseQueryService.main(DatabaseQueryService.java:34)
2024-05-01 14:29:33.331235+03:00 database: flush
org.h2.message.DbException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.message.DbException.convert(DbException.java:407)
	at org.h2.mvstore.db.Store.lambda$new$0(Store.java:122)
	at org.h2.mvstore.MVStore.handleException(MVStore.java:1546)
	at org.h2.mvstore.MVStore.panic(MVStore.java:371)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:291)
	at org.h2.mvstore.MVStore$Builder.open(MVStore.java:2035)
	at org.h2.mvstore.db.Store.<init>(Store.java:133)
	at org.h2.engine.Database.<init>(Database.java:326)
	at org.h2.engine.Engine.openSession(Engine.java:92)
	at org.h2.engine.Engine.openSession(Engine.java:222)
	at org.h2.engine.Engine.createSession(Engine.java:201)
	at org.h2.engine.SessionRemote.connectEmbeddedOrServer(SessionRemote.java:343)
	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:125)
	at org.h2.Driver.connect(Driver.java:59)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:683)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:253)
	at org.boichenko.Database.<init>(Database.java:13)
	at org.boichenko.Database.<clinit>(Database.java:9)
	at org.boichenko.services.DatabaseQueryService.findYoungestEldestWorker(DatabaseQueryService.java:42)
	at org.boichenko.services.DatabaseQueryService.main(DatabaseQueryService.java:34)
Caused by: org.h2.jdbc.JdbcSQLNonTransientException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:566)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	... 21 more
Caused by: org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:996)
	at org.h2.mvstore.SingleFileStore.lockFileChannel(SingleFileStore.java:143)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:117)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:81)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:286)
	... 15 more
2024-05-01 14:29:38.646166+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Столбец "birthday" не найден
Column "birthday" not found [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.jdbc.JdbcResultSet.getColumnIndex(JdbcResultSet.java:3518)
	at org.h2.jdbc.JdbcResultSet.getString(JdbcResultSet.java:301)
	at org.boichenko.services.DatabaseQueryService.findYoungestEldestWorker(DatabaseQueryService.java:54)
	at org.boichenko.services.DatabaseQueryService.main(DatabaseQueryService.java:34)
2024-05-01 14:31:04.222493+03:00 database: flush
org.h2.message.DbException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.message.DbException.convert(DbException.java:407)
	at org.h2.mvstore.db.Store.lambda$new$0(Store.java:122)
	at org.h2.mvstore.MVStore.handleException(MVStore.java:1546)
	at org.h2.mvstore.MVStore.panic(MVStore.java:371)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:291)
	at org.h2.mvstore.MVStore$Builder.open(MVStore.java:2035)
	at org.h2.mvstore.db.Store.<init>(Store.java:133)
	at org.h2.engine.Database.<init>(Database.java:326)
	at org.h2.engine.Engine.openSession(Engine.java:92)
	at org.h2.engine.Engine.openSession(Engine.java:222)
	at org.h2.engine.Engine.createSession(Engine.java:201)
	at org.h2.engine.SessionRemote.connectEmbeddedOrServer(SessionRemote.java:343)
	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:125)
	at org.h2.Driver.connect(Driver.java:59)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:683)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:253)
	at org.boichenko.Database.<init>(Database.java:13)
	at org.boichenko.Database.<clinit>(Database.java:9)
	at org.boichenko.services.DatabaseQueryService.findYoungestEldestWorker(DatabaseQueryService.java:42)
	at org.boichenko.services.DatabaseQueryService.main(DatabaseQueryService.java:34)
Caused by: org.h2.jdbc.JdbcSQLNonTransientException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:566)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	... 21 more
Caused by: org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:996)
	at org.h2.mvstore.SingleFileStore.lockFileChannel(SingleFileStore.java:143)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:117)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:81)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:286)
	... 15 more
2024-05-01 14:31:21.610365+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Столбец "birthday" не найден
Column "birthday" not found [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.jdbc.JdbcResultSet.getColumnIndex(JdbcResultSet.java:3518)
	at org.h2.jdbc.JdbcResultSet.getString(JdbcResultSet.java:301)
	at org.boichenko.services.DatabaseQueryService.findYoungestEldestWorker(DatabaseQueryService.java:54)
	at org.boichenko.services.DatabaseQueryService.main(DatabaseQueryService.java:34)
2024-05-01 14:39:08.524020+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Функция "AGE" не найдена
Function "AGE" not found; SQL statement:
SELECT project_id, MAX(salary*months) AS price FROM

    (SELECT project_id, SUM(salary) AS salary FROM worker
                                                       JOIN project_worker ON project_worker.worker_id = worker.id
     GROUP BY project_id) t1

        LEFT JOIN

    (SELECT id, (EXTRACT(year FROM AGE(finish_date, start_date)) * 12 +
                 EXTRACT(month FROM AGE(finish_date, start_date))) AS months
     FROM project
    ) t2
    ON t1.project_id = t2.id
GROUP BY project_id
ORDER BY price DESC; [90022-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.Parser.readFunction(Parser.java:3786)
	at org.h2.command.Parser.readTermWithIdentifier(Parser.java:5148)
	at org.h2.command.Parser.readTerm(Parser.java:4834)
	at org.h2.command.Parser.readFactor(Parser.java:3337)
	at org.h2.command.Parser.readSum(Parser.java:3324)
	at org.h2.command.Parser.readConcat(Parser.java:3289)
	at org.h2.command.Parser.readCondition(Parser.java:3079)
	at org.h2.command.Parser.readExpression(Parser.java:2999)
	at org.h2.command.Parser.readSingleArgument(Parser.java:4466)
	at org.h2.command.Parser.readBuiltinFunctionIf(Parser.java:4095)
	at org.h2.command.Parser.readFunction(Parser.java:3768)
	at org.h2.command.Parser.readTermWithIdentifier(Parser.java:5148)
	at org.h2.command.Parser.readTerm(Parser.java:4834)
	at org.h2.command.Parser.readFactor(Parser.java:3337)
	at org.h2.command.Parser.readSum(Parser.java:3324)
	at org.h2.command.Parser.readConcat(Parser.java:3289)
	at org.h2.command.Parser.readCondition(Parser.java:3079)
	at org.h2.command.Parser.readExpression(Parser.java:2999)
	at org.h2.command.Parser.readTermWithoutIdentifier(Parser.java:4929)
	at org.h2.command.Parser.readTerm(Parser.java:4834)
	at org.h2.command.Parser.readFactor(Parser.java:3337)
	at org.h2.command.Parser.readSum(Parser.java:3324)
	at org.h2.command.Parser.readConcat(Parser.java:3289)
	at org.h2.command.Parser.readCondition(Parser.java:3079)
	at org.h2.command.Parser.readExpression(Parser.java:2999)
	at org.h2.command.Parser.parseSelectExpressions(Parser.java:2799)
	at org.h2.command.Parser.parseSelect(Parser.java:2817)
	at org.h2.command.Parser.parseQueryPrimary(Parser.java:2708)
	at org.h2.command.Parser.parseQueryTerm(Parser.java:2564)
	at org.h2.command.Parser.parseQueryExpressionBody(Parser.java:2543)
	at org.h2.command.Parser.parseQueryExpressionBodyAndEndOfQuery(Parser.java:2536)
	at org.h2.command.Parser.parseQueryExpression(Parser.java:2529)
	at org.h2.command.Parser.readDerivedTableWithCorrelation(Parser.java:1821)
	at org.h2.command.Parser.readTablePrimary(Parser.java:1720)
	at org.h2.command.Parser.readTableReference(Parser.java:2268)
	at org.h2.command.Parser.readTableReference(Parser.java:2285)
	at org.h2.command.Parser.parseSelectFromPart(Parser.java:2718)
	at org.h2.command.Parser.parseSelect(Parser.java:2824)
	at org.h2.command.Parser.parseQueryPrimary(Parser.java:2708)
	at org.h2.command.Parser.parseQueryTerm(Parser.java:2564)
	at org.h2.command.Parser.parseQueryExpressionBody(Parser.java:2543)
	at org.h2.command.Parser.parseQueryExpressionBodyAndEndOfQuery(Parser.java:2536)
	at org.h2.command.Parser.parseQueryExpression(Parser.java:2529)
	at org.h2.command.Parser.parseQuery(Parser.java:2498)
	at org.h2.command.Parser.parsePrepared(Parser.java:627)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeQuery(JdbcStatement.java:94)
	at org.boichenko.services.DatabaseQueryService.printProjectPrices(DatabaseQueryService.java:37)
	at org.boichenko.services.DatabaseQueryService.main(DatabaseQueryService.java:25)
2024-05-01 14:39:35.328000+03:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Функция "AGE" не найдена
Function "AGE" not found; SQL statement:
SELECT project_id, MAX(salary*months) AS price FROM

    (SELECT project_id, SUM(salary) AS salary FROM worker
                                                       JOIN project_worker ON project_worker.worker_id = worker.id
     GROUP BY project_id) t1

        LEFT JOIN

    (SELECT id, (EXTRACT(year FROM AGE(finish_date, start_date)) * 12 +
                 EXTRACT(month FROM AGE(finish_date, start_date))) AS months
     FROM project
    ) t2
    ON t1.project_id = t2.id
GROUP BY project_id
ORDER BY price DESC [90022-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.Parser.readFunction(Parser.java:3786)
	at org.h2.command.Parser.readTermWithIdentifier(Parser.java:5148)
	at org.h2.command.Parser.readTerm(Parser.java:4834)
	at org.h2.command.Parser.readFactor(Parser.java:3337)
	at org.h2.command.Parser.readSum(Parser.java:3324)
	at org.h2.command.Parser.readConcat(Parser.java:3289)
	at org.h2.command.Parser.readCondition(Parser.java:3079)
	at org.h2.command.Parser.readExpression(Parser.java:2999)
	at org.h2.command.Parser.readSingleArgument(Parser.java:4466)
	at org.h2.command.Parser.readBuiltinFunctionIf(Parser.java:4095)
	at org.h2.command.Parser.readFunction(Parser.java:3768)
	at org.h2.command.Parser.readTermWithIdentifier(Parser.java:5148)
	at org.h2.command.Parser.readTerm(Parser.java:4834)
	at org.h2.command.Parser.readFactor(Parser.java:3337)
	at org.h2.command.Parser.readSum(Parser.java:3324)
	at org.h2.command.Parser.readConcat(Parser.java:3289)
	at org.h2.command.Parser.readCondition(Parser.java:3079)
	at org.h2.command.Parser.readExpression(Parser.java:2999)
	at org.h2.command.Parser.readTermWithoutIdentifier(Parser.java:4929)
	at org.h2.command.Parser.readTerm(Parser.java:4834)
	at org.h2.command.Parser.readFactor(Parser.java:3337)
	at org.h2.command.Parser.readSum(Parser.java:3324)
	at org.h2.command.Parser.readConcat(Parser.java:3289)
	at org.h2.command.Parser.readCondition(Parser.java:3079)
	at org.h2.command.Parser.readExpression(Parser.java:2999)
	at org.h2.command.Parser.parseSelectExpressions(Parser.java:2799)
	at org.h2.command.Parser.parseSelect(Parser.java:2817)
	at org.h2.command.Parser.parseQueryPrimary(Parser.java:2708)
	at org.h2.command.Parser.parseQueryTerm(Parser.java:2564)
	at org.h2.command.Parser.parseQueryExpressionBody(Parser.java:2543)
	at org.h2.command.Parser.parseQueryExpressionBodyAndEndOfQuery(Parser.java:2536)
	at org.h2.command.Parser.parseQueryExpression(Parser.java:2529)
	at org.h2.command.Parser.readDerivedTableWithCorrelation(Parser.java:1821)
	at org.h2.command.Parser.readTablePrimary(Parser.java:1720)
	at org.h2.command.Parser.readTableReference(Parser.java:2268)
	at org.h2.command.Parser.readTableReference(Parser.java:2285)
	at org.h2.command.Parser.parseSelectFromPart(Parser.java:2718)
	at org.h2.command.Parser.parseSelect(Parser.java:2824)
	at org.h2.command.Parser.parseQueryPrimary(Parser.java:2708)
	at org.h2.command.Parser.parseQueryTerm(Parser.java:2564)
	at org.h2.command.Parser.parseQueryExpressionBody(Parser.java:2543)
	at org.h2.command.Parser.parseQueryExpressionBodyAndEndOfQuery(Parser.java:2536)
	at org.h2.command.Parser.parseQueryExpression(Parser.java:2529)
	at org.h2.command.Parser.parseQuery(Parser.java:2498)
	at org.h2.command.Parser.parsePrepared(Parser.java:627)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1109)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1096)
	at org.h2.server.web.WebThread.process(WebThread.java:190)
	at org.h2.server.web.WebThread.run(WebThread.java:103)
	at java.lang.Thread.run(Unknown Source)
2024-05-01 14:47:23.785506+03:00 database: flush
org.h2.message.DbException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.message.DbException.convert(DbException.java:407)
	at org.h2.mvstore.db.Store.lambda$new$0(Store.java:122)
	at org.h2.mvstore.MVStore.handleException(MVStore.java:1546)
	at org.h2.mvstore.MVStore.panic(MVStore.java:371)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:291)
	at org.h2.mvstore.MVStore$Builder.open(MVStore.java:2035)
	at org.h2.mvstore.db.Store.<init>(Store.java:133)
	at org.h2.engine.Database.<init>(Database.java:326)
	at org.h2.engine.Engine.openSession(Engine.java:92)
	at org.h2.engine.Engine.openSession(Engine.java:222)
	at org.h2.engine.Engine.createSession(Engine.java:201)
	at org.h2.engine.SessionRemote.connectEmbeddedOrServer(SessionRemote.java:343)
	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:125)
	at org.h2.Driver.connect(Driver.java:59)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:683)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:253)
	at org.boichenko.Database.<init>(Database.java:13)
	at org.boichenko.Database.<clinit>(Database.java:9)
	at org.boichenko.services.DatabaseQueryService.findMaxProjectsClient(DatabaseQueryService.java:145)
	at org.boichenko.Main.main(Main.java:10)
Caused by: org.h2.jdbc.JdbcSQLNonTransientException: Внутренняя ошибка: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]"
General error: "org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]" [50000-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:566)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	... 21 more
Caused by: org.h2.mvstore.MVStoreException: The file is locked: D:/projects/Hybernate/HW-2-6/db40.mv.db [2.2.224/7]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:996)
	at org.h2.mvstore.SingleFileStore.lockFileChannel(SingleFileStore.java:143)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:117)
	at org.h2.mvstore.SingleFileStore.open(SingleFileStore.java:81)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:286)
	... 15 more
